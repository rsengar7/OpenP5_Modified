2024-10-30 15:19:47,443 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML100K_collaborative.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '4,5', 'master_addr': 'localhost', 'master_port': '1994', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'collaborative', 'tasks': 'sequential,straightforward', 'datasets': 'ML100K', 'prompt_file': '../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 100, 'collaborative_cluster': 10, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'seen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 20, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'rank': 0, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 0, 'test_filtered_batch': 1, 'log_name': '1_1_1_1_20_1994_ML100K_sequential,straightforward_t5-small_collaborative_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML100K_collaborative.pt'}
2024-10-30 15:19:47,726 - root - INFO - Generating data for ML100K dataset
2024-10-30 15:19:47,726 - root - INFO - Get prompt template from ../prompt.txt
2024-10-30 15:19:47,727 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2024-10-30 15:19:47,728 - root - INFO - Required info: ['user_id', 'target', 'history', 'dataset']
2024-10-30 15:19:47,729 - root - INFO - Reindex data with collaborative indexing method with token_size 100 and 10 cluster
2024-10-30 15:19:47,731 - root - INFO - loading training data
2024-10-30 15:19:47,733 - root - INFO - Getting prompt information
2024-10-30 15:19:47,744 - root - INFO - Input: Here is the purchase history of ML100K user_1 : ML100K item item_<CI2><CI20><CI18> , item_<CI3><CI33><CI3> , item_<CI5><CI54><CI3> , item_<CI1><CI12><CI1> , item_<CI2><CI21><CI4> , item_<CI1><CI13><CI15> , item_<CI2><CI20><CI12> , item_<CI2><CI20><CI20> , item_<CI2><CI29><CI2> , item_<CI8><CI45> , item_<CI2><CI24><CI11> , item_<CI3><CI33><CI4> , item_<CI1><CI13><CI12> , item_<CI5><CI51><CI4> , item_<CI1><CI17><CI14> , item_<CI4><CI49><CI4> , item_<CI1><CI12><CI16> , item_<CI1><CI12><CI13> , item_<CI6><CI64> , item_<CI1><CI12><CI5> . I wonder what is the next recommended item for the user . , Output: ML100K item_<CI1><CI13><CI13> 
2024-10-30 15:19:47,796 - root - INFO - Use t5-small backbone model
2024-10-30 15:19:48,166 - root - INFO - Random initialize number related tokens
2024-10-30 15:19:49,415 - root - INFO - Load model from ../checkpoint/ML100K_collaborative.pt
2024-10-30 15:19:52,612 - root - INFO - {'seed': 2023, 'model_dir': '../model', 'checkpoint_dir': '../checkpoint', 'model_name': 'ML100K_collaborative.pt', 'log_dir': '../log', 'distributed': 1, 'gpu': '4,5', 'master_addr': 'localhost', 'master_port': '1994', 'logging_level': 20, 'data_path': '../data', 'item_indexing': 'collaborative', 'tasks': 'sequential,straightforward', 'datasets': 'ML100K', 'prompt_file': '../prompt.txt', 'sequential_order': 'original', 'collaborative_token_size': 100, 'collaborative_cluster': 10, 'collaborative_last_token': 'sequential', 'collaborative_float32': 0, 'max_his': 20, 'his_prefix': 1, 'his_sep': ' , ', 'skip_empty_his': 1, 'valid_prompt': 'seen:0', 'valid_prompt_sample': 1, 'valid_sample_num': '3,3', 'test_prompt': 'unseen:0', 'sample_prompt': 1, 'sample_num': '3,3', 'batch_size': 128, 'eval_batch_size': 20, 'dist_sampler': 0, 'optim': 'AdamW', 'epochs': 10, 'lr': 0.001, 'clip': 1, 'logging_step': 100, 'warmup_prop': 0.05, 'gradient_accumulation_steps': 1, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'dropout': 0.1, 'alpha': 2, 'rank': 0, 'train': 0, 'backbone': 't5-small', 'metrics': 'hit@5,hit@10,ndcg@5,ndcg@10', 'load': 0, 'random_initialize': 1, 'test_epoch': 0, 'valid_select': 0, 'test_before_train': 0, 'test_filtered': 0, 'test_filtered_batch': 1, 'log_name': '1_1_1_1_20_1994_ML100K_sequential,straightforward_t5-small_collaborative_0.001_10_128_3,3_prompt', 'model_path': '../checkpoint/ML100K_collaborative.pt'}
2024-10-30 15:19:52,846 - root - INFO - Generating data for ML100K dataset
2024-10-30 15:19:52,846 - root - INFO - Get prompt template from ../prompt.txt
2024-10-30 15:19:52,846 - root - INFO - Considering {dataset} user_{user_id} has interacted with {dataset} items {history} . What is the next recommendation for the user ?
2024-10-30 15:19:52,847 - root - INFO - Required info: ['dataset', 'user_id', 'history', 'target']
2024-10-30 15:19:52,847 - root - INFO - Reindex data with collaborative indexing method with token_size 100 and 10 cluster
2024-10-30 15:19:52,848 - root - INFO - loading training data
2024-10-30 15:19:52,850 - root - INFO - Getting prompt information
2024-10-30 15:19:52,862 - root - INFO - Input: Here is the purchase history of ML100K user_1 : ML100K item item_<CI2><CI20><CI18> , item_<CI3><CI33><CI3> , item_<CI5><CI54><CI3> , item_<CI1><CI12><CI1> , item_<CI2><CI21><CI4> , item_<CI1><CI13><CI15> , item_<CI2><CI20><CI12> , item_<CI2><CI20><CI20> , item_<CI2><CI29><CI2> , item_<CI8><CI45> , item_<CI2><CI24><CI11> , item_<CI3><CI33><CI4> , item_<CI1><CI13><CI12> , item_<CI5><CI51><CI4> , item_<CI1><CI17><CI14> , item_<CI4><CI49><CI4> , item_<CI1><CI12><CI16> , item_<CI1><CI12><CI13> , item_<CI6><CI64> , item_<CI1><CI12><CI5> . I wonder what is the next recommended item for the user . , Output: ML100K item_<CI1><CI13><CI13> 
2024-10-30 15:19:52,910 - root - INFO - Use t5-small backbone model
2024-10-30 15:19:53,239 - root - INFO - Random initialize number related tokens
2024-10-30 15:19:54,412 - root - INFO - Load model from ../checkpoint/ML100K_collaborative.pt
